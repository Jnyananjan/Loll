<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  </head>
  <body>
    <a-scene 
      color-space="sRGB" 
      renderer="colorManagement: true, physicallyCorrectLights" 
      vr-mode-ui="enabled: false" 
      device-orientation-permission-ui="enabled: false"
    >
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <!-- MindAR Image Targets -->
      <a-assets>
        <video id="video1" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//Batch2k25.mp4" webkit-playsinline playsinline></video>
        <video id="video2" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//wirdos.mp4" webkit-playsinline playsinline></video>
        <video id="video3" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//eatting.mp4" webkit-playsinline playsinline></video>
        <video id="video4" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//u.mp4" webkit-playsinline playsinline></video>
        <video id="video5" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//3idiot.mp4" webkit-playsinline playsinline></video>
        <video id="video6" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//uno.mp4" webkit-playsinline playsinline></video>
        <video id="video7" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//as.mp4" webkit-playsinline playsinline></video>
        <video id="video8" src="https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ar-content//ad.mp4" webkit-playsinline playsinline></video>
      </a-assets>

      <!-- Entities for Each Image Target -->
      <script>
        const mindFiles = [
          "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/batch2k25//Batch2k25.mind", "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/wirdos//wirdos.mind", "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/3idiot//3idiot.mind", "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/eatting//eatting.mind", 
          "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/u//u.mind", "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/uno//uno.mind", "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/as//as.mind", "https://dhkyzhpqoreeytuyeioj.supabase.co/storage/v1/object/public/ad//ad.mind"
        ];
        const targets = [];

        mindFiles.forEach((mindFile, i) => {
          targets.push(`<a-entity mindar-image="imageTargetSrc: ${mindFile}" mindar-image-target="targetIndex: 0">
            <a-video id="videoEntity${i + 1}" src="#video${i + 1}" width="1.5" height="1" visible="false"></a-video>
          </a-entity>`);
        });
        document.write(targets.join(""));
      </script>
    </a-scene>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        for (let i = 0; i < 8; i++) {
          const targetEntity = document.querySelector(`[mindar-image-target='targetIndex: 0']`);
          const video = document.getElementById(`video${i + 1}`);
          const videoEntity = document.getElementById(`videoEntity${i + 1}`);

          targetEntity.addEventListener("targetFound", () => {
            videoEntity.setAttribute("visible", "true");
            video.play();
          });

          targetEntity.addEventListener("targetLost", () => {
            video.pause();
            video.currentTime = 0;
            videoEntity.setAttribute("visible", "false");
          });
        }
      });
    </script>
  </body>
</html>
